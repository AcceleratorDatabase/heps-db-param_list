<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <title>Parameter Data</title>
    </h:head>
    <h:body>
        <h:form id="paraForm">

            <p:dataTable id="datas" var="data" value="#{dataMB.dataDispList}" editable="true" editMode="cell"    paginator="true" rows="20" sortMode="multiple" >
                <f:facet name="header">
                    <h:outputText value=" List of Parameter Values" style="font-size: 24px;color:royalblue"/>  
                    <p:commandButton id="toggler" type="button" value="Choose Columns to View" style="float:left;color: blueviolet" icon="ui-icon-calculator" />
                    <p:columnToggler datasource="datas" trigger="toggler">
                        <p:ajax event="toggle" listener="#{dataMB.onToggle}"/>                 			 
                    </p:columnToggler>
                </f:facet>                            
                <p:ajax event="cellEdit" listener="#{dataMB.cellEdit}"/>
               
                <p:column style="width:10px">
                <p:rowToggler> 

                </p:rowToggler>      
                </p:column>

                <p:column visible="#{dataMB.stateList[0]}" >
                    <f:facet name="header">
                        <h:outputText value="Id"/>
                    </f:facet>
                    <h:outputText value="#{data.id}" />        
                </p:column>
                <p:column sortBy="#{data.system}" filterBy="#{data.system}" filterMatchMode="contains"  visible="#{dataMB.stateList[1]}">
                    <f:facet name="header">
                        <h:outputText value="System"/>
                    </f:facet>
                    <h:outputText value="#{data.system}"/>
                </p:column>
                <p:column  sortBy="#{data.subsystem}" filterBy="#{data.subsystem}"  filterMatchMode="contains" visible="#{dataMB.stateList[2]}">
                    <f:facet name="header">
                        <h:outputText value="Subsystem"/>
                    </f:facet>
                    <h:outputText value="#{data.subsystem}"/>
                </p:column>
                <p:column filterBy="#{data.device}"  filterMatchMode="contains" visible="#{dataMB.stateList[3]}">
                    <f:facet name="header">
                        <h:outputText value="Device Type"/>
                    </f:facet>
                    <h:outputText value="#{data.device}"/>
                </p:column>
                <p:column visible="#{dataMB.stateList[4]}">
                    <f:facet name="header">
                        <h:outputText value="Parameter Name"/>
                    </f:facet>
                    <h:outputText value="#{data.parameterName}"/>               
                </p:column>
                <p:column visible="#{dataMB.stateList[5]}">
                    <f:facet name="header">
                        <h:outputText value="Attribute"/>
                    </f:facet>
                    <h:outputText value="#{data.attibute}"/>               
                </p:column>
                <p:column visible="#{dataMB.stateList[6]}">
                    <f:facet name="header">
                        <h:outputText value="Unit"/>
                    </f:facet>
                    <h:outputText value="#{data.unit}"/>               
                </p:column>
                <p:column visible="#{dataMB.stateList[7]}">

                    <f:facet name="header">
                        <h:outputText value="Value"/>
                    </f:facet>
                    <p:cellEditor>
                        <f:facet name="output">
                            <h:outputText  value="#{data.value}"/>  
                        </f:facet>
                        <f:facet  name="input">
                            <h:inputText  value="#{data.value}" style="color:red" />  
                        </f:facet>
                    </p:cellEditor> 
                </p:column>
                <p:column visible="#{dataMB.stateList[8]}">
                    <f:facet name="header">
                        <h:outputText value="Change Date"/>
                    </f:facet>
                    <h:outputText value="#{data.changeDate}"> 
                        <f:convertDateTime timeZone="GMT+8" pattern="yyyy/MM/dd" locale="zh"/>
                    </h:outputText>
                </p:column>
                <p:column visible="#{dataMB.stateList[9]}">
                    <f:facet name="header">
                        <h:outputText value="Definition"/>
                    </f:facet>
                    <h:outputText value="#{data.definition}"/>               
                </p:column>
                <p:column visible="#{dataMB.stateList[10]}">
                    <f:facet name="header">
                        <h:outputText value="Reference Title"/>
                    </f:facet>
                    <h:outputText value="#{data.referenceTitle}"/>               
                </p:column>
                <p:column visible="#{dataMB.stateList[11]}">
                    <f:facet name="header">
                        <h:outputText value="Reference Author"/>
                    </f:facet>
                    <h:outputText value="#{data.referenceAuthor}"/>               
                </p:column>
                <p:column visible="#{dataMB.stateList[12]}">
                    <f:facet name="header">
                        <h:outputText value="Reference Publication"/>
                    </f:facet>
                    <h:outputText value="#{data.referencePublication}"/>               
                </p:column>
                <p:column visible="#{dataMB.stateList[13]}">
                    <f:facet name="header">
                        <h:outputText value="Reference URL"/>
                    </f:facet>
                    <h:outputText value="#{data.referenceURL}"/>               
                </p:column>
                <p:column visible="#{dataMB.stateList[14]}">
                    <f:facet name="header">
                        <h:outputText value="Keyword"/>
                    </f:facet>
                    <h:outputText value="#{data.keyword}"/>               
                </p:column>


                <p:rowExpansion id="expandedText">
                    <p:dataTable id="historyValueDatas"  var="historyData" value="#{data.data.historyDataList}" style="width:400px"  paginator="true" rows="10">
    
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Modified Value"/>
                            </f:facet>
                            <h:outputText value="#{historyData.value}"/>               
                        </p:column>

                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Modified Date"/>
                            </f:facet>
                            <h:outputText value="#{historyData.dateModified}"> 
                                <f:convertDateTime timeZone="GMT+8" pattern="yyyy/MM/dd" locale="zh"/>
                            </h:outputText>
                        </p:column>
                        
                       

                    </p:dataTable>
                </p:rowExpansion>

            </p:dataTable>

        </h:form>
    </h:body>
</html>

